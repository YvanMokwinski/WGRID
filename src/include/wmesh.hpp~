#pragma once

#include "wmesh.h"
#include "wfe_element.h"
#include "wmesh-types.hpp"

extern "C"
{

  struct wmesh_t
  {
    //    wspace_sparse_c2n_t 	m_c2n;    
    wmesh_int_sparsemat_t 	m_c2n;
    wmesh_int_sparsemat_t 	m_c2e;

    wmesh_int_sparsemat_t 	m_c2f;
    wmesh_int_sparsemat_t 	m_c2f_t;
    wmesh_int_sparsemat_t 	m_c2f_q;

    wmesh_int_sparsemat_t 	m_c2c;
    wmesh_int_sparsemat_t 	m_c2c_t;
    wmesh_int_sparsemat_t 	m_c2c_q;

    wmesh_int_sparsemat_t 	m_s_e2n;    
    wmesh_int_sparsemat_t 	m_s_t2n;    
    wmesh_int_sparsemat_t 	m_s_q2n;    

    wmesh_int_sparsemat_t 	m_bf2n;
    
#if 1
    wmesh_int_sparsemat_t 	m_c2d;
    wmesh_int_sparsemat_t 	m_c2d_n;
    wmesh_int_sparsemat_t 	m_c2d_e;
    wmesh_int_sparsemat_t 	m_c2d_t;
    wmesh_int_sparsemat_t 	m_c2d_q;
    wmesh_int_sparsemat_t 	m_c2d_i;
    double * 			m_coo_dofs;    
    wmesh_int_t 		m_ndofs;
#endif

    wmesh_int_t 		m_num_entities[WFE_ELEMENT_ALL];
    wmesh_int_t 		m_num_bfaces[2];
    
    double * 			m_coo;    
    wmesh_int_p			m_flag_nodes;
    wmesh_int_p			m_flag_cells;
    wmesh_int_p                 m_flag_bfaces;
    
    wmesh_int_t 		m_num_cells;
    wmesh_int_t 		m_num_nodes;
    wmesh_int_t 		m_num_edges;
    wmesh_int_t 		m_num_faces;
    wmesh_int_t 		m_num_volumes;
    wmesh_int_t 		m_num_triangles;
    wmesh_int_t 		m_num_quadrilaterals;
    wmesh_int_t 		m_num_tetrahedra;
    wmesh_int_t 		m_num_pyramid;
    wmesh_int_t 		m_num_wedge;
    wmesh_int_t 		m_num_hexahedra;
  };
};
